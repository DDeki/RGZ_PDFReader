(function(){var e={117:function(e,t,n){"use strict";var o=n(5130),a=n(6768);const i=(0,a.Lk)("nav",null,null,-1);function s(e,t){const n=(0,a.g2)("router-view");return(0,a.uX)(),(0,a.CE)("div",null,[i,(0,a.bF)(n)])}var l=n(1241);const r={},d=(0,l.A)(r,[["render",s]]);var c=d,u=n(1387),h=n(4232);const p=e=>((0,a.Qi)("data-v-aaf060e0"),e=e(),(0,a.jt)(),e),f={class:"file-selector container-fluid",style:{"font-family":"Arial"}},g={class:"row",style:{"padding-top":"10px"}},k={class:"col-12 text-end"},v=["disabled"],L=p((()=>(0,a.Lk)("span",null,[(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,a.Lk)("path",{d:"M12 3v12"}),(0,a.Lk)("polyline",{points:"9 15 12 18 15 15"}),(0,a.Lk)("path",{d:"M19 21H5"})]),(0,a.eW)(" као WORD ")],-1))),b=[L],w=["disabled"],m=p((()=>(0,a.Lk)("span",null,[(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,a.Lk)("path",{d:"M12 20h9"}),(0,a.Lk)("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L10 16H7v-3L16.5 3.5z"})]),(0,a.eW)(" Уреди ")],-1))),y=[m],x=["disabled"],_=p((()=>(0,a.Lk)("span",null,[(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,a.Lk)("rect",{x:"9",y:"9",width:"13",height:"13",rx:"2",ry:"2"}),(0,a.Lk)("path",{d:"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"})]),(0,a.eW)(" Копирај ")],-1))),A=[_],T={class:"row"},C={class:"middle-content col-sm-6"},E={key:0,class:"pdf-viewer"},F=["src"],U={class:"right-content col-sm-6",style:{height:"70vh"}},M=["innerHTML"],D={key:0,class:"loading-overlay"},O=p((()=>(0,a.Lk)("div",{class:"spinner"},null,-1))),j=[O],P={class:"row"},R={class:"col-sm-6 text-center"},N={class:"row"},S=p((()=>(0,a.Lk)("div",{class:"col-sm-1",style:{height:"20vh"}},null,-1))),I={class:"col-sm-4",style:{height:"20vh"},ref:"leftContent"},V={key:0,class:"drop-text",style:{"font-weight":"bold"}},$={key:1,class:"file-info",style:{"font-weight":"bold"}},X=p((()=>(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-file"},[(0,a.Lk)("path",{d:"M14 3v4a1 1 0 0 0 1 1h4"}),(0,a.Lk)("path",{d:"M21 15v4a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7"})],-1))),B={class:"col-sm-4 text-center"},W=p((()=>(0,a.Lk)("div",{class:"row",style:{"max-height":"10vh"}},[(0,a.Lk)("div",{class:"col-sm-12 text-center"},[(0,a.Lk)("p",{style:{"font-weight":"bold"}}," Језик документа: ")])],-1))),H={class:"row"},K={class:"col-sm-12 text-center"},Q={class:"radio-buttons"},q={class:"radio-label"},z=["disabled"],G=p((()=>(0,a.Lk)("span",{class:"radio-custom"},null,-1))),Y={class:"radio-label"},J=["disabled"],Z=p((()=>(0,a.Lk)("span",{class:"radio-custom"},null,-1))),ee={class:"radio-label"},te=["disabled"],ne=p((()=>(0,a.Lk)("span",{class:"radio-custom"},null,-1))),oe={class:"col-sm-3 text-center"},ae=p((()=>(0,a.Lk)("p",null,[(0,a.Lk)("br")],-1))),ie=["disabled"],se={key:0},le={key:1},re=p((()=>(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,a.Lk)("path",{d:"M12 19V6"}),(0,a.Lk)("polyline",{points:"5 12 12 5 19 12"}),(0,a.Lk)("path",{d:"M5 19h14"})],-1))),de=p((()=>(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[(0,a.Lk)("path",{d:"M19 5L5 19M5 5l14 14"})],-1))),ce={class:"col-sm-6 text-center"},ue={class:"row",style:{"max-height":"10vh"}},he={class:"col-sm-12 text-center"},pe={key:0,style:{"font-weight":"bold"}},fe=p((()=>(0,a.Lk)("br",null,null,-1))),ge={key:1,style:{"font-weight":"bold"}},ke=p((()=>(0,a.Lk)("br",null,null,-1))),ve=p((()=>(0,a.Lk)("br",null,null,-1))),Le=p((()=>(0,a.Lk)("br",null,null,-1))),be=[ke,ve,Le],we={class:"row"},me={class:"col-sm-12 text-center"};function ye(e,t,n,i,s,l){return(0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("div",g,[(0,a.Lk)("div",k,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...t)=>e.downloadDoc&&e.downloadDoc(...t)),disabled:!e.fileUploaded||e.isLoading,class:"copy-button"},b,8,v),(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...t)=>e.editTextArea&&e.editTextArea(...t)),disabled:!e.fileUploaded||e.isLoading,class:"copy-button"},y,8,w),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...t)=>e.copyTextToClipboard&&e.copyTextToClipboard(...t)),disabled:!e.fileUploaded||e.isLoading,class:"copy-button"},A,8,x)])]),(0,a.Lk)("div",T,[(0,a.Lk)("div",C,[e.pdfFile?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("embed",{src:`${this.pdfFile}#zoom=80&rotate=180`,type:"application/pdf",width:"100%",style:{height:"70vh"}},null,8,F)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",U,[(0,a.Lk)("div",{ref:"textarea",innerHTML:e.formattedAlertMessage,readonly:"",class:"alert-message",style:{"text-align":"left","font-weight":"bold","white-space":"pre-wrap","overflow-y":"auto",height:"300px",padding:"8px"},onInput:t[3]||(t[3]=(...t)=>e.handleInput&&e.handleInput(...t))},null,40,M)]),e.isLoading?((0,a.uX)(),(0,a.CE)("div",D,j)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",P,[(0,a.Lk)("div",R,[(0,a.Lk)("div",N,[S,(0,a.Lk)("div",I,[(0,a.Lk)("div",{class:(0,h.C4)(["drop-area",{dragging:e.isDragging}]),onDragover:t[5]||(t[5]=(0,o.D$)((()=>{}),["prevent"])),onDrop:t[6]||(t[6]=(...t)=>e.handleDrop&&e.handleDrop(...t)),onDragenter:t[7]||(t[7]=(...t)=>e.dragEnter&&e.dragEnter(...t)),onDragleave:t[8]||(t[8]=(...t)=>e.dragLeave&&e.dragLeave(...t)),onClick:t[9]||(t[9]=(...t)=>e.openFileExplorer&&e.openFileExplorer(...t)),style:{height:"20vh"}},[e.file?((0,a.uX)(),(0,a.CE)("p",$,[X,(0,a.eW)(" "+(0,h.v_)(e.file.name),1)])):((0,a.uX)(),(0,a.CE)("p",V,"Превуци фајл овде или кликни да би претражио...")),(0,a.Lk)("input",{ref:"fileInput",type:"file",style:{display:"none"},onChange:t[4]||(t[4]=(...t)=>e.handleFileInput&&e.handleFileInput(...t))},null,544)],34)],512),(0,a.Lk)("div",B,[W,(0,a.Lk)("div",H,[(0,a.Lk)("div",K,[(0,a.Lk)("div",Q,[(0,a.Lk)("label",q,[(0,a.bo)((0,a.Lk)("input",{type:"radio","onUpdate:modelValue":t[10]||(t[10]=t=>e.selectedLanguage=t),value:"srp",class:"radio-input",disabled:e.isLoading},null,8,z),[[o.XL,e.selectedLanguage]]),G,(0,a.eW)(" Српски ")]),(0,a.Lk)("label",Y,[(0,a.bo)((0,a.Lk)("input",{type:"radio","onUpdate:modelValue":t[11]||(t[11]=t=>e.selectedLanguage=t),value:"srp_latn",class:"radio-input",disabled:e.isLoading},null,8,J),[[o.XL,e.selectedLanguage]]),Z,(0,a.eW)(" Srpski (Latinica) ")]),(0,a.Lk)("label",ee,[(0,a.bo)((0,a.Lk)("input",{type:"radio","onUpdate:modelValue":t[12]||(t[12]=t=>e.selectedLanguage=t),value:"eng",class:"radio-input",disabled:e.isLoading},null,8,te),[[o.XL,e.selectedLanguage]]),ne,(0,a.eW)(" Engleski ")])])])])]),(0,a.Lk)("div",oe,[ae,(0,a.Lk)("button",{onClick:t[13]||(t[13]=(...t)=>e.sendFileToFastAPI&&e.sendFileToFastAPI(...t)),disabled:e.isLoading||!e.file,class:"upload-button"},[e.isLoading?((0,a.uX)(),(0,a.CE)("span",se,"Учитавање...")):((0,a.uX)(),(0,a.CE)("span",le,[re,(0,a.eW)(" Преведи фајл ")]))],8,ie),(0,a.Lk)("button",{onClick:t[14]||(t[14]=(...t)=>e.clearFile&&e.clearFile(...t)),class:"upload-button"},[de,(0,a.eW)(" Уклони фајл ")])])])]),(0,a.Lk)("div",ce,[(0,a.Lk)("div",ue,[(0,a.Lk)("div",he,[e.is_bet&&!e.backActive||!e.is_bet&&e.backActive?((0,a.uX)(),(0,a.CE)("p",pe,[fe,(0,a.eW)("*Ако нисте задовољни овим транскриптом кликните на дугме испод.")])):((0,a.uX)(),(0,a.CE)("p",ge,be))])]),(0,a.Lk)("div",we,[(0,a.Lk)("div",me,[(e.is_bet&&!e.backActive||!e.is_bet&&e.backActive)&&!e.isLoading?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[15]||(t[15]=(...t)=>e.secondUpload&&e.secondUpload(...t)),class:"copy-button"},"Други начин")):(0,a.Q3)("",!0),!e.isLoading&&e.backActive?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t[16]||(t[16]=(...t)=>e.backToFirst&&e.backToFirst(...t)),class:"copy-button",style:{"min-width":"200px"}},"Врати се назад")):(0,a.Q3)("",!0)])])])])])}n(6573),n(8100),n(7936),n(7467),n(4732),n(9577),n(4979),n(4603),n(7566),n(8721);var xe=n(8355),_e=n(788),Ae=n(4463),Te=n(1024);const Ce={url:{NODE_ENV:"production",BASE_URL:"/ocr-home/"}.VUE_APP_LOGIN_PATH,realm:{NODE_ENV:"production",BASE_URL:"/ocr-home/"}.VUE_APP_KEYCLOAK_REALM,clientId:{NODE_ENV:"production",BASE_URL:"/ocr-home/"}.VUE_APP_KEYCLOAK_CLIENTID},Ee=new Te.A(Ce);var Fe=Ee;const Ue={NODE_ENV:"production",BASE_URL:"/ocr-home/"}.VUE_APP_BACKEND_PATH;var Me={data(){return{file:null,file_name:"",pdfFile:null,isDragging:!1,is_there_better:!1,alertMessage:"",firstText:"",secondText:"",backActive:!1,fileUploaded:!1,isLoading:!1,currentPage:1,pageCount:10,pdfViewer:null,pageNumber:1,highlighted_pdf:null,selectedLanguage:"srp"}},mounted(){console.log("MOUNTED HOME.");const e=new URLSearchParams(window.location.hash.substring(1));e.has("state")||e.has("code")?(console.log("Cleaning up URL..."),window.history.replaceState({},document.title,"/ocr-home")):console.log("No URL cleanup needed.")},computed:{formattedAlertMessage(){const e=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;"),t=e(this.alertMessage);return t.replace(/(?<=\s|^)@@(\S*)/g,'<span style="color: red;">$&</span>')}},methods:{handleInput(e){const t=this.saveCursorPosition(),n=e.target.innerText;n!==this.alertMessage&&(this.alertMessage=n,this.$nextTick((()=>{this.restoreCursorPosition(t)})))},saveCursorPosition(){const e=window.getSelection();if(e.rangeCount>0){const t=e.getRangeAt(0),n=t.cloneRange();return n.selectNodeContents(this.$refs.textarea),n.setEnd(t.endContainer,t.endOffset),n.toString().length}return 0},restoreCursorPosition(e){const t=document.createRange();t.setStart(this.$refs.textarea,0),t.collapse(!0);const n=document.createTreeWalker(this.$refs.textarea,NodeFilter.SHOW_TEXT,null,!1);let o,a=0;while(n.nextNode()){o=n.currentNode;const i=o.nodeValue.length;if(e<=a+i){t.setStart(o,e-a),t.collapse(!0);break}a+=i}const i=window.getSelection();i.removeAllRanges(),i.addRange(t)},downloadDoc(){try{const e=this.$refs.textarea.innerText,t=e.split("\n"),n=new Ae.fzL({children:t.flatMap(((e,n)=>[new Ae.NTc(e),...n<t.length-1?[new Ae.NTc({text:"",break:1})]:[]]))}),o=new Ae.yoT({sections:[{children:[n]}]}),a=this.file_name.replace(/\.pdf$/,"");Ae.ND6.toBlob(o).then((e=>{(0,_e.saveAs)(e,a+".docx")}))}catch{alert("Skidanje dokumenta neuspesno, ucitajte fajl ponovo")}},editTextArea(){const e=this.$refs.textarea;"true"===e.getAttribute("contenteditable")?e.setAttribute("contenteditable","false"):e.setAttribute("contenteditable","true"),this.$refs.textarea.focus()},clearFile(){this.pdfFile&&URL.revokeObjectURL(this.pdfFile),this.file=null,this.file_name="",this.pdfFile=null,this.fileUploaded=!1,this.is_bet=!1,this.alertMessage="",this.firstText="",this.secondText="",this.backActive=!1,this.$refs.fileInput.value="",this.$refs.textarea.setAttribute("readonly","readonly")},handleDrop(e){e.preventDefault(),this.isDragging=!1;const t=e.dataTransfer.items[0].webkitGetAsEntry();this.traverseFileTree(t)},traverseFileTree(e){e.isFile&&e.file((e=>{this.file=e,this.pdfFile=URL.createObjectURL(e)}))},dragEnter(e){e.preventDefault(),this.isDragging=!0},dragLeave(){this.isDragging=!1},openFileExplorer(){this.$refs.fileInput.click()},handleFileInput(e){const t=e.target.files[0];if("application/pdf"!==t.type)return void alert("Nevalidan format, samo je PDF dozvoljen.");this.file=t;const n=URL.createObjectURL(t);this.pdfFile=n,this.file_name=t.name.replace(/\.pdf$/,"")},async sendFileToFastAPI(){if(!this.file)return;this.isLoading=!0,this.is_bet=!1,this.firstText="",this.secondText="",this.backActive=!1;const e=Fe.tokenParsed.preferred_username;console.log(e);const t=new FormData;t.append("language_sent",this.selectedLanguage),t.append("file",this.file),t.append("username",e);try{const e=await xe.A.post(Ue+"/upload/",t),n=e.data.message,o=e.data.is_there_better;if(this.is_bet=o,this.alertMessage=n,this.firstText=n,this.fileUploaded=!0,e.data.highlighted_pdf){const t=window.atob(e.data.highlighted_pdf),n=t.length,o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=t.charCodeAt(e);const a=new Blob([o.buffer],{type:"application/pdf"}),i=URL.createObjectURL(a);this.pdfFile=i}}catch(n){alert("Vas PDF nije validan, pokusajte ponovo")}finally{this.$refs.textarea.setAttribute("contenteditable","false"),this.isLoading=!1}},copyTextToClipboard(){this.alertMessage?navigator.clipboard.writeText(this.alertMessage).then((()=>{console.log("Text copied to clipboard")})).catch((e=>{console.error("Unable to copy text to clipboard",e)})):console.error("No text available to copy")},async secondUpload(){if(0!=this.secondText.localeCompare(""))return this.alertMessage=this.secondText,void(this.backActive=!0);this.isLoading=!0;const e=Fe.tokenParsed.preferred_username,t=new FormData;t.append("language_sent",this.selectedLanguage),t.append("file",this.file),t.append("username",e);try{const e=await xe.A.post(Ue+"/second_upload/",t,{headers:{"Content-Type":"multipart/form-data"}}),n=e.data.message;if(this.alertMessage=n,this.secondText=n,this.backActive=!0,this.fileUploaded=!0,e.data.highlighted_pdf){const t=window.atob(e.data.highlighted_pdf),n=t.length,o=new Uint8Array(n);for(let e=0;e<n;e++)o[e]=t.charCodeAt(e);const a=new Blob([o.buffer],{type:"application/pdf"}),i=URL.createObjectURL(a);this.pdfFile=i}}catch(n){alert("Vas PDF nije validan, pokusajte ponovo")}finally{this.$refs.textarea.setAttribute("contenteditable","false"),this.isLoading=!1}},backToFirst(){this.alertMessage=this.firstText,this.backActive=!1}}},De={...Me};const Oe=(0,l.A)(De,[["render",ye],["__scopeId","data-v-aaf060e0"]]);var je=Oe;const Pe=[{path:"/",name:"home",component:je,meta:{requiresAuth:!0}},{path:"/:catchAll(.*)",redirect:"/"}],Re=(0,u.aE)({history:(0,u.LA)("/ocr-home/"),routes:Pe});Re.beforeEach(((e,t,n)=>{e.matched.some((e=>e.meta.requiresAuth))?Fe.authenticated?n():Fe.login():n()}));var Ne=Re;Fe.init({onLoad:"login-required"}).then((e=>{if(e){const e=(0,o.Ef)(c);e.use(Ne),e.mount("#app")}else window.location.reload();setInterval((()=>{Fe.updateToken(70).then((e=>{e?console.log("Token refreshed"):console.warn("Token not refreshed, valid for "+Math.round(Fe.tokenParsed.exp+Fe.timeSkew-(new Date).getTime()/1e3)+" seconds")})).catch((()=>{console.error("Failed to refresh token")}))}),6e4)})).catch((()=>{console.error("Authentication Failed")}))},1903:function(){},4394:function(){}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.m=e,function(){n.amdO={}}(),function(){var e=[];n.O=function(t,o,a,i){if(!o){var s=1/0;for(c=0;c<e.length;c++){o=e[c][0],a=e[c][1],i=e[c][2];for(var l=!0,r=0;r<o.length;r++)(!1&i||s>=i)&&Object.keys(n.O).every((function(e){return n.O[e](o[r])}))?o.splice(r--,1):(l=!1,i<s&&(s=i));if(l){e.splice(c--,1);var d=a();void 0!==d&&(t=d)}}return t}i=i||0;for(var c=e.length;c>0&&e[c-1][2]>i;c--)e[c]=e[c-1];e[c]=[o,a,i]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,i,s=o[0],l=o[1],r=o[2],d=0;if(s.some((function(t){return 0!==e[t]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(r)var c=r(n)}for(t&&t(o);d<s.length;d++)i=s[d],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return n.O(c)},o=self["webpackChunkpdf_reader_app_client"]=self["webpackChunkpdf_reader_app_client"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(117)}));o=n.O(o)})();
//# sourceMappingURL=app.a5e50549.js.map